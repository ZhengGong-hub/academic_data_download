SELECT
    f.gvkey,
    f.datadate,
    f.fyear,
    {{ fund_list | join(', ') }}
FROM comp.funda f
WHERE f.indfmt = 'INDL' -- industrial format (excluding financial companies, but financial services companies ok)
AND f.datafmt = 'STD' -- standard format
AND f.consol  = 'C' -- consolidated financials (parents + subsidiaries, standard)
AND f.popsrc  = 'D' -- domestic companies only
AND f.curncd = 'USD' -- US dollars as native currency of reporting only
AND f.fyear >= {{ start_year }}
AND f.datadate IS NOT NULL
{% if gvkey_list %}
AND f.gvkey IN ('{{ gvkey_list | join("','") }}')
{% endif %}
ORDER BY f.datadate ASC