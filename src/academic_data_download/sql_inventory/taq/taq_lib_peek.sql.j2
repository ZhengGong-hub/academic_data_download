SELECT 
a.*
FROM taqm_{{year}}.wct_{{date}} a
WHERE 
a.time_m < TIME '09:30:00'
AND a.time_m < TIME '16:00:00'
-- AND a.type = 'T'                                    -- trade record
-- AND (a.tr_scond IS NULL OR a.tr_scond !~ '[OQ6M]')  -- exclude open/close prints
-- AND a.ex = 'D'                                      -- off-exchange
AND a.nbo IS NOT NULL AND a.nbo > 0
AND a.nbb IS NOT NULL AND a.nbb > 0
AND (a.nbo - a.nbb) > 0                             -- positive spread
AND a.size > 0
-- AND a.size * a.price < 100000
-- AND ABS(price*100-ROUND(price*100))>1e-6                -- drop penny-edge prints FAST
{% if sym_root_list %}
AND a.sym_root IN ('{{ sym_root_list | join("','") }}')
{% endif %}